+++
date = '2025-10-29T22:37:10+01:00'
draft = false
title = '5ª Sessão - 27/10/2025'
+++

# 5ª Sessão - 27/10/2025

## Exercícios

Esta sessão foi dedicada à resolução do primeiro conjunto de exercícios: [If statements](../exercicios/001_if_statements).

## Conceitos abordados

### Validação dos inputs

Quando recebemos inputs do utilizador (por exemplo, através de `prompt()`), é importante validar esses inputs antes de os começar a utilizar no programa.
A validação pode ser mais ou menos rigorosa dependendo do contexto, mas devemos sempre pensar no tipo de validação de input que queremos.

#### Validação de números

Tipicamente a validar inputs de números queremos validar duas coisas:

1. Se o valor inserido é um número válido
2. Se o número está dentro de um intervalo aceitável

##### Números válidos - `IsNaN()`

Uma vez que o input recebido através de `prompt()` é sempre uma string, quando esperamos um número, devemos converter o input para número usando `Number()`.

```javascript
let idadeInput = prompt("Insira a sua idade:");
let idade = Number(idadeInput);
```

Esta conversão de número para string pode correr mal, sobretudo se o utilizador colocar algo que não é um número.
Quando a conversão correr mal, `Number()` devolve o valor `NaN` (Not a Number).
Por isso, para ver se a conversão correu bem, devemos verificar se o valor resultante não é `NaN`.
Para validar se o valor inserido é um número válido, podemos usar a função `isNaN()`.

```javascript
if (isNaN(idade)) {
    console.log("Por favor, insira um número válido para a idade.");
} else {
    console.log("Idade válida:", idade);
}
```

{{% hint tip %}}
No caso do `NaN`, não podemos comparar o valor diretamente com NaN (ou seja, `idade === NaN` não funciona), porque em Javascript `NaN` não é igual a nada, nem mesmo a ele próprio.
`NaN` é o único valor em Javascript que não é igual a ele próprio.
Para todos os outros valores em Javascript, `x === x` é sempre `true`.
{{% /hint %}}

##### Valor dentro de intervalos aceitáveis

Depois de verificar que um utilizador inseriu um número válido, podemos querer validar se o número está dentro de um intervalo aceitável.
Por exemplo, se estivermos a pedir a idade de uma pessoa, podemos querer garantir que a idade está entre 0 e 120 anos.

```javascript
if (idade < 0 || idade > 120) {
    console.log("Por favor, insira uma idade entre 0 e 120 anos.");
} else {
    console.log("Idade válida:", idade);
}
```

Uma possível validação completa para a idade poderia ser:

```javascript
let idadeInput = prompt("Insira a sua idade:");
let idade = Number(idadeInput);

if (isNaN(idade)) {
    console.log("Por favor, insira um número válido para a idade.");
} else if (idade < 0 || idade > 120) {
    console.log("Por favor, insira uma idade entre 0 e 120 anos.");
} else {
    console.log("Idade válida:", idade);
}
```

### Validação de strings

Quando validamos strings, normalmente queremos garantir que:

- A string não está vazia (ou seja, é diferente de `"""`).
- A string está dentro de um conjunto de valores aceitáveis (por exemplo, "sim" ou "nao").

{{% hint tip %}}
A validação e tratamento de strings pode ser bastante complexa dependendo do contexto.
Iremos falar mais sobre tratamento de strings e validações em sessões futuras, mas para já vamos considerar apenas estas duas formas simples de validação de strings.
{{% /hint %}}

Para validar que uma string não está vazia, podemos comparar com a string vazia `""`.

```javascript
let cidadania = prompt("Insira a sua cidadania:");
if (cidadania === "") {
    console.log("Por favor, insira uma cidadania válida.");
}
```

Para validar que uma string está dentro de um conjunto de valores aceitáveis, podemos usar múltiplas comparações com `||`.

```javascript
let direitoVotoInput = prompt("Tens direito de voto? (sim/nao)");
if (direitoVotoInput !== "sim" && direitoVotoInput !== "nao") {
    console.log("Por favor, insira 'sim' ou 'nao' para o direito de voto.");
}
```

### Terminar o programa cedo com `Deno.exit()`

Às vezes, quando validamos inputs do utilizador, se o input for inválido, queremos terminar o programa imediatamente.
Os programas que temos visto até aqui são relativamente simples e terminam naturalmente quando chegam ao fim do código.
Para estes programas, um conjunto de `if` statements é suficiente para controlar o fluxo do programa.

No entanto, em programas mais complexos, pode ser útil terminar o programa imediatamente quando um input é inválido.
Para isso, podemos usar a função `Deno.exit()` que termina o programa imediatamente.

```javascript
let idadeInput = prompt("Insira a sua idade:");
let idade = Number(idadeInput);

if (isNaN(idade) || idade < 0 || idade > 120) {
    console.log("Idade inválida. O programa vai terminar.");
    Deno.exit(1); // Termina o programa com código de erro 1
}

console.log("Idade válida:", idade);
```

Uma coisa interessante a notar neste programa é que depois de chamarmos `Deno.exit()`, o programa termina imediatamente, por isso o código que vem depois não é executado.
Por esse motivo, não precisamos de colocar o resto do código dentro de um bloco `else` e a última linha do programa é executada apenas se a idade for válida.
Ou seja, terminar o programa cedo em caso de erro ajuda a que o fluxo do código seja mais linear e fácil de ler.

#### Códigos de saída

Os códigos de saída dos programas indicam ao sistema operativo se o programa terminou com sucesso ou com erro.
A forma como o programa pode dizer isto ao sistema operativo é através do código de saída, que é um número.
Por convenção, um código de saída `0` indica que o programa terminou com sucesso, enquanto qualquer código diferente de `0` indica que o programa terminou com um erro.
A ideia é que apenas há uma forma do programa correr bem (código `0`), mas podem haver muitas razões diferentes para o programa correr mal (códigos diferentes de `0`).

Todas as linguagens têm uma função quer permite terminar o programa mais cedo que o previsto, e geralmente estas funções permitem especificar o código de saída.
Quando não se usa esta função de saída, o sistema assume que o programa terminou com sucesso (código `0`).

Em Deno, a função para terminar o programa é `Deno.exit()` e também permite especificar o código de saída. 
Podemos usar diferentes códigos de erro para indicar diferentes tipos de erros, no entanto, usar um código de erro `1` com `Deno.exit(1)` é suficiente geralmente.
Raramente precisamos de indicar que o programa terminou com sucesso, por isso vermos `Deno.exit(0)` é raro - apenas deixar o programa terminar naturalmente tem o mesmo efeito.

### Usar a documentação para mais informação

O Javascript e o Deno têm muita documentação que permite compreender melhor como funcionam certos aspectos da linguagem.
Por exemplo, podemos querer saber mais sobre como funciona a conversão para número com `Number()`, ou como funciona a função `isNaN()`, ou como usar `Deno.exit()`.
A documentação oficial é um recurso muito útil para aprender mais sobre estes tópicos.

Uma das documentações mais completas e úteis para Javascript é o [MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/JavaScript).
O Deno é um motor de Javascript, e como tal segue a especificação do Javascript, por isso a documentação da MDN é aplicável ao Deno.

Para coisas que são específicas a Deno, como a função `prompt()` ou `Deno.exit()`, podemos consultar a [documentação do Deno](https://deno.land/manual).
Apesar de coisas como `prompt()` serem standards web que existem fora do Deno, a documentação do Deno explica as particularidades de como estas funcionam no contexto do Deno.

Alguns links para documentação relacionados com coisas que já vimos:

- [MDN Number()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number) - Tem exemplos de como usar `Number()` e qual o "algoritmo" usado para converter strings (ou outros valores!) para números.
- [MDN isNaN()](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/isNaN) - Explica como funciona `isNaN()` e tem exemplos de uso.
- [Deno Prompts](https://docs.deno.com/examples/prompts/) - Explica como usar a função `prompt()` no Deno, assim como algumas variantes para pedir input ao utilizador (ver `confirm()` por exemplo)
- [MDN Deno.exit()](https://docs.deno.com/api/deno/~/Deno.exit) - Explica como usar `Deno.exit()`.

### Operador ternário `? :`

O operador ternário é uma forma concisa de escrever um `if` statement simples que escolhe entre dois valores com base numa condição.

Por exemplo, nos exercícios, vimos que queremos por o valor de uma variável `direitoVoto` para `true` ou `false` com base no input do utilizador.

```javascript
let direitoVotoInput = prompt("Tens direito de voto? (sim/nao)");
let direitoVoto;
if (direitoVotoInput=== "sim") {
    direitoVoto = true;
} else {
    direitoVoto = false;
}
```

Este `if` statement pode ser reescrito usando o operador ternário da seguinte forma:

```javascript
let direitoVotoInput = prompt("Tens direito de voto? (sim/nao)");
let direitoVoto = (direitoVotoInput === "sim") ? true : false;
```

De forma geral, o operador ternário tem a seguinte sintaxe:

```javascript
condição ? valor_se_verdadeiro : valor_se_falso
```

Onde `condição` é uma expressão booleana, `valor_se_verdadeiro` é o valor que será usado se a condição for verdadeira, e `valor_se_falso` é o valor que será usado se a condição for falsa.

Os valores podem ser de qualquer tipo, incluindo números, strings, booleanos, ou até expressões mais complexas.
Por exemplo:

```javascript
let idade = 20;
let categoria = (idade < 18) ? "Criança" : "Adulto";
console.log(categoria); // Imprime "Adulto"
```

Podemos ver o operador como sendo a forma simplificada de um `if` statement que escolhe entre dois valores.
Tal como nos `if statements`, também com o operador ternário podemos aninhar várias condições. 

```javascript
let idade = 70;
let categoria = (idade < 13) ? "Criança" :
                (idade < 18) ? "Adolescente" :
                (idade < 65) ? "Adulto" :
                "Idoso";
console.log(categoria); // Imprime "Idoso"
```

Que seria equivalente a:

```javascript
let idade = 70;
let categoria
if (idade < 13) {
    categoria = "Criança";
} else if (idade < 18) {
    categoria = "Adolescente";
} else if (idade < 65) {
    categoria = "Adulto";
} else {
    categoria = "Idoso";
}
console.log(categoria); // Imprime "Idoso"
```

## Para praticar

Ver [If statements (Parte 2)](../exercicios/002_if_statements).
